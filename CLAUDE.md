# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## 言語設定

**重要**: このプロジェクトでは日本語を主言語として使用します。
- コミットメッセージ：日本語で記述
- コード内のコメント：日本語で記述
- ドキュメント：日本語で記述
- Claude Codeとのやりとり：日本語で実施

## プロジェクト概要

**gitlab_repo_analyzer** - GitLabリポジトリを分析するNode.jsベースのツール（現在初期セットアップ段階）

## 開発環境

- **ランタイム**: Node.js 22
- **開発環境**: VS Code Dev Containers
- **パッケージマネージャー**: npm

## コマンド

### 開発
```bash
# 依存関係のインストール
npm install

# アプリケーションの実行（index.js作成後）
node index.js

# テストの実行（テストフレームワーク設定後）
npm test
```

## アーキテクチャ

このプロジェクトは初期セットアップ段階です。実装時の指針：

1. **エントリーポイント**: `index.js`をメインエントリーポイントとして作成（package.jsonで参照済み）
2. **GitLab統合**: GitLab APIを使用してリポジトリ分析を実装
3. **分析機能**: 以下の実装を検討：
   - リポジトリ構造分析
   - コード品質メトリクス
   - 依存関係分析
   - セキュリティ脆弱性スキャン
   - コミット履歴分析

## 開発ガイドライン

1. **プロジェクト構造**: コードを論理的なモジュールに整理：
   - `/src` - メインソースコード
   - `/lib` - 再利用可能なユーティリティ
   - `/test` - テストファイル
   - `/config` - 設定ファイル

2. **エラーハンドリング**: API障害やエッジケースに対する堅牢なエラーハンドリングを実装

3. **設定**: GitLab APIトークンと設定には環境変数を使用

4. **テスト**: 機能追加前にテストフレームワーク（JestまたはMocha）をセットアップ

5. **リンティング**: コードの一貫性のためESLint設定を追加

## 次のステップ

プロジェクト開発時：
1. 基本的なプロジェクト構造を作成
2. GitLab API認証をセットアップ
3. コア分析機能を実装
4. 適切なエラーハンドリングとロギングを追加
5. 包括的なテストを作成
6. ドキュメントを追加

## 開発ワークフロー

### Claude Code 使用時の権限設定
```bash
# セキュリティを考慮した最小権限設定
claude --allowedTools "Bash(git:*),Bash(gh:*),Bash(npm:*),Bash(node:*),Bash(mkdir:*),Bash(rm:*)"
```

### PR作成ルール
- **必須プロセス**: 全ての修正作業はPRを通して行う
- **事前検証**: コミット前に必ずlint、typecheck、testを実行
- **日本語使用**: PRタイトルとコミットメッセージは日本語で記述
- **レビュー**: 作業完了後は必ずPRを作成し、適切なレビューを経る

### 権限エラー対応手順
- **根本原因**: ディレクトリ作成権限（mkdir）の不足
- **対策**: 必要最小限のコマンド権限を明示的に許可
- **セキュリティ**: 全般的なbash権限ではなく、コマンド単位での制御
- **監視**: 権限エラー発生時はログを確認し、必要最小限の権限のみ追加
- **文書化**: 解決後はCLAUDE.mdに手順を追記

### 開発コマンド実行順序
1. 依存関係インストール: `npm install`
2. 型チェック: `npm run typecheck`
3. リンター実行: `npm run lint` 
4. テスト実行: `npm test`
5. Git操作: `git add .`, `git commit`, `git push`